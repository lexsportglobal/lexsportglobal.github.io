<!DOCTYPE HTML>
<html>
<head>
    <title>Data Scouting - LEX SPORT GLOBAL</title>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no" />
    <link rel="stylesheet" href="assets/css/main.css" />
    <style>
        /* --- 1. PRESENTATION & TEXTE BILINGUE --- */
        .image.main img { max-height: 400px; object-fit: cover; border-bottom: 3px solid #C5A05F; }
        .bilingual-grid { display: flex; gap: 40px; margin-top: 30px; border-bottom: 1px solid #333; padding-bottom: 40px; }
        .lang-box { flex: 1; padding: 20px; line-height: 1.8; text-align: justify; }
        .lang-box h2 { color: #C5A05F; font-size: 1.5em; margin-bottom: 1em; text-transform: uppercase; }
        @media screen and (max-width: 736px) { .bilingual-grid { flex-direction: column; } }

        /* --- 2. FILTRES (CENTRAGE ABSOLU) --- */
        .filter-section { width: 100%; text-align: center; margin: 50px 0 30px 0; }
        .filter-bar { display: inline-flex; justify-content: center; gap: 15px; flex-wrap: wrap; }
        .filter-btn {
            background: transparent !important;
            color: #D4AF37 !important;
            border: 2px solid #D4AF37 !important;
            padding: 10px 25px !important;
            font-weight: 800 !important;
            text-transform: uppercase;
            cursor: pointer;
            transition: 0.3s;
            border-radius: 4px;
            letter-spacing: 1px;
        }
        .filter-btn:hover { background: #D4AF37 !important; color: #000 !important; }

        /* --- 3. GRILLE & CARTES --- */
        #players-container { display: grid; grid-template-columns: repeat(auto-fit, minmax(280px, 1fr)); gap: 30px; padding: 20px; }
        .player-card { 
            background: linear-gradient(145deg, #232323, #1a1a1a); 
            border: 1px solid #D4AF37; 
            border-radius: 15px; 
            padding: 35px 20px; 
            text-align: center; /* Centrage du texte dans la carte */
            position: relative;
        }
        .player-card h3 { 
            color: #FFFFFF !important; 
            font-size: 1.1em !important; /* Taille r√©duite pour plus de finesse */ 
            font-weight: 800 !important; 
            margin: 10px 0 5px 0; /* Marges r√©duites */ 
            text-transform: uppercase;
            line-height: 1.2; /* Pour √©viter que √ßa prenne trop de place en hauteur */
}
        .player-card .position { color: #D4AF37 !important; font-weight: bold; display: block; margin-bottom: 15px; }
        .player-card img { width: 130px; height: 130px; border-radius: 50%; border: 3px solid #D4AF37; object-fit: cover; }

        /* --- 4. BADGES --- */
        .player-badge { position: absolute; top: 15px; right: 15px; padding: 4px 12px; border-radius: 20px; font-size: 9px; font-weight: 900; text-transform: uppercase; }
        .status-pro { background: #D4AF37; color: #000; }
        .status-free { background: #000; color: #D4AF37; border: 1px solid #D4AF37; }
        .status-amateur { background: #444; color: #fff; }

        /* --- 5. MODALE --- */
        .modal { display: none; position: fixed; z-index: 10000; left: 0; top: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.9); backdrop-filter: blur(5px); }
        .modal-content { background: #1a1a1a; margin: 5% auto; padding: 30px; border: 1px solid #D4AF37; width: 95%; max-width: 500px; border-radius: 15px; color: white; position: relative; }
        .close-modal { position: absolute; right: 20px; top: 10px; color: #D4AF37; font-size: 35px; cursor: pointer; }
    </style>
</head>
<body class="is-preload">
    <div id="wrapper">
        <div id="main">
            <div class="inner">
                <header id="header">
                    <a href="index.html" class="logo">
                        <img src="images/logo_final.jpg" alt="" style="height: 30px; vertical-align: middle; margin-right: 10px;" />
                        <strong>LEX SPORT GLOBAL</strong> | Performance & Analytics
                    </a>
                </header>

                <section>
                    <header class="main">
                        <h1 style="color: #002349; letter-spacing: 2px;">Data Scouting & Performance</h1>
                    </header>
                    <span class="image main"><img src="images/scouting_data.jpg" alt="Data Analytics" /></span>

                    <div class="bilingual-grid">
                        <div class="lang-box" style="border-right: 1px solid #333;">
                            <h2>[FR] Analyse Pr√©dictive</h2>
                            <p>Le d√©partement <strong>Data Scouting</strong> de Lex Sport Global transforme l'observation traditionnelle en une science exacte. Nous accompagnons les clubs dans l'identification de talents √† haute valeur ajout√©e via l'identification par KPIs et la valorisation financi√®re.</p>
                        </div>
                        <div class="lang-box">
                            <h2>[EN] Predictive Analytics</h2>
                            <p>The <strong>Data Scouting</strong> department at Lex Sport Global turns traditional observation into an exact science. We assist clubs in identifying high-value talent through KPI-based identification and financial valuation.</p>
                        </div>
                    </div>
                    <div style="text-align: center; margin-bottom: 20px;">
                        <p style="font-style: italic; color: #888; font-size: 0.9em; margin-bottom: 10px;">Vous √™tes un club ou un agent ind√©pendant ?</p>
                        <a href="add-player.html" class="button primary" style="background-color: #D4AF37 !important; color: #000 !important; font-weight: 900; border-radius: 5px; box-shadow: 0 4px 15px rgba(212, 175, 55, 0.2);">
                           ‚ûï INSCRIRE UN TALENT
                       </a>
                    </div>

                    <div class="filter-section">
                        <div class="filter-bar">
                            <button class="filter-btn" onclick="filterPlayers('all')">Tous</button>
                            <button class="filter-btn" onclick="filterPlayers('pro')">Pros</button>
                            <button class="filter-btn" onclick="filterPlayers('amateur')">Amateurs</button>
                            <button class="filter-btn" onclick="filterPlayers('free agent')">Free Agents</button>
                        </div>
                    </div>

                    <div id="players-container"></div>
                </section>
            </div>
        </div>
    </div>

    <div id="playerModal" class="modal">
        <div class="modal-content">
            <span class="close-modal">&times;</span>
            <div id="modalDetails"></div>
        </div>
    </div>

    <script src="assets/js/jquery.min.js"></script>
    <script src="assets/js/main.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>

    <script>
        document.addEventListener('DOMContentLoaded', function() {
            let allPlayers = [];
            const supabaseUrl = 'https://kjhrikutzxixmvmhbjqk.supabase.co';
            const supabaseKey = 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImtqaHJpa3V0enhpeG12bWhianFrIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NzEyNzg4NzQsImV4cCI6MjA4Njg1NDg3NH0.df9_4U08BN-NPNaXYXsyWTkSZqoNT7UtF_Iz8lx6HZo';

            async function fetchPlayers() {
                try {
                    // On ajoute .eq('is_active', true) pour ne voir que les profils valid√©s
                        const response = await fetch(`${supabaseUrl}/rest/v1/players?is_active=eq.true&select=*`, {
                       headers: { 'apikey': supabaseKey, 'Authorization': `Bearer ${supabaseKey}` }
                        });
                       allPlayers = await response.json();
                        displayPlayers(allPlayers);
                } catch (error) { console.error("Erreur:", error); }
            }

            window.displayPlayers = function(players) {
                const container = document.getElementById('players-container');
                container.innerHTML = '';
                players.forEach((player, index) => {
                    let s = (player.status || 'Amateur').toLowerCase();
                    let bClass = s === 'pro' ? 'status-pro' : (s.includes('free') ? 'status-free' : 'status-amateur');
                    
                    container.innerHTML += `
                        <div class="player-card">
                            <div class="player-badge ${bClass}">${player.status || 'Amateur'}</div>
                            <img src="${player.photo_url || 'https://via.placeholder.com/150'}" alt="">
                            <h3>${player.full_name}</h3>
                            <span class="position">üìç ${player.position || 'N/A'}</span>
                            <button onclick="showDetailsByName('${player.full_name.replace(/'/g, "\\'")}')" style="width:100%; background:#D4AF37 !important; color:#000 !important; font-weight:900; border:none; height:45px; border-radius:5px; cursor:pointer; margin-top:15px; text-transform:uppercase;">VIEW PROFILE</button>
                        </div>`;
                });
            }

            window.filterPlayers = function(cat) {
                const filtered = (cat === 'all') 
                    ? allPlayers 
                    : allPlayers.filter(p => (p.status || '').toLowerCase().includes(cat.toLowerCase()));
                displayPlayers(filtered);
            };

            window.showDetailsByName = function(name) {
                const player = allPlayers.find(p => p.full_name === name);
                if(!player) return;
                const details = document.getElementById("modalDetails");
                details.innerHTML = `
                    <h2 style="color:#D4AF37; text-transform:uppercase; margin-bottom:10px;">${player.full_name}</h2>
                    <p style="color:#888;">${player.position} | ${player.nationality}</p>
                    <div style="display:grid; grid-template-columns:1fr 1fr; gap:15px; margin-top:20px; border-top:1px solid #333; padding-top:15px;">
                        <div><label style="color:#D4AF37; font-size:10px; display:block; text-transform:uppercase;">Pied</label>${player.preferred_foot || 'N/A'}</div>
                        <div><label style="color:#D4AF37; font-size:10px; display:block; text-transform:uppercase;">Valeur</label>${player.market_value || 'N/A'}</div>
                        <div><label style="color:#D4AF37; font-size:10px; display:block; text-transform:uppercase;">Taille</label>${player.height || 'N/A'}</div>
                        <div><label style="color:#D4AF37; font-size:10px; display:block; text-transform:uppercase;">Contrat</label>${player.contract_end || 'N/A'}</div>
                    </div>
                    <div style="margin-top:25px; padding:15px; background:#222; border-left:4px solid #D4AF37; font-style:italic;">
                        <span style="display:block; font-weight:bold; color:#D4AF37; font-style:normal; margin-bottom:5px;">SCOUT REPORT :</span>
                        "${player.scout_comment || 'Analyse en cours...'}"
                    </div>`;
                document.getElementById("playerModal").style.display = "block";
            };

            const modal = document.getElementById("playerModal");
            document.querySelector(".close-modal").onclick = () => modal.style.display = "none";
            window.onclick = (e) => { if(e.target == modal) modal.style.display = "none"; };

            fetchPlayers();
        });
    </script>
</body>
</html>




