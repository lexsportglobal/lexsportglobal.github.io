<!DOCTYPE HTML>
<html>
<head>
    <title>Data Scouting - LEX SPORT GLOBAL</title>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no" />
    <link rel="stylesheet" href="assets/css/main.css" />
    <style>
    /* 1. Barres de Filtres : Centrage parfait */
    .filter-bar {
        display: flex !important;
        justify-content: center !important; /* Centre horizontalement */
        align-items: center !important;
        gap: 15px;
        margin: 40px auto;
        flex-wrap: wrap;
        max-width: 800px;
    }

    /* 2. Boutons de Filtres : Look Pro */
    .filter-btn {
        background: transparent !important;
        color: #D4AF37 !important;
        border: 2px solid #D4AF37 !important;
        padding: 12px 24px !important;
        font-weight: 800 !important;
        text-transform: uppercase;
        cursor: pointer;
        transition: 0.3s;
        border-radius: 4px;
    }

    .filter-btn:hover { background: #D4AF37 !important; color: #000 !important; }

    /* 3. Cartes Joueurs : Centrage du texte */
    .player-card {
        text-align: center !important; /* Aligne tout le texte au centre */
        padding: 30px 20px !important;
    }

    /* 4. Noms des Joueurs : Impact Maximum */
    .player-card h3 {
        color: #FFFFFF !important;
        font-size: 1.5rem !important;
        font-weight: 900 !important;
        margin: 15px 0 5px 0 !important;
        text-transform: uppercase;
        letter-spacing: 1px;
    }

    .player-card .position {
        color: #D4AF37 !important;
        font-weight: bold;
        display: block;
        margin-bottom: 20px;
    }
</style>
</head>
<body class="is-preload">
    <div id="wrapper">
        <div id="main">
            <div class="inner">
                <header id="header">
                    <a href="index.html" class="logo">
                        <img src="images/logo_final.jpg" alt="Logo" style="height: 30px; vertical-align: middle;" />
                        <strong>LEX SPORT GLOBAL</strong> | Performance & Analytics
                    </a>
                </header>

                <section>
                    <header class="main"><h1>Data Scouting</h1></header>
                    <span class="image main"><img src="images/scouting_data.jpg" alt="" /></span>

                    <div class="filter-bar">
                        <button class="filter-btn" onclick="filterPlayers('all')">TOUS</button>
                        <button class="filter-btn" onclick="filterPlayers('pro')">PROS</button>
                        <button class="filter-btn" onclick="filterPlayers('amateur')">AMATEURS</button>
                        <button class="filter-btn" onclick="filterPlayers('free agent')">FREE AGENTS</button>
                    </div>

                    <div id="players-container"></div>
                </section>
            </div>
        </div>
    </div>

    <div id="playerModal" class="modal">
        <div class="modal-content">
            <span class="close-modal">&times;</span>
            <div id="modalDetails"></div>
        </div>
    </div>

    <script src="assets/js/jquery.min.js"></script>
    <script src="assets/js/main.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>

    <script>
        document.addEventListener('DOMContentLoaded', function() {
            let allPlayers = [];
            const supabaseUrl = 'https://kjhrikutzxixmvmhbjqk.supabase.co';
            const supabaseKey = 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImtqaHJpa3V0enhpeG12bWhianFrIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NzEyNzg4NzQsImV4cCI6MjA4Njg1NDg3NH0.df9_4U08BN-NPNaXYXsyWTkSZqoNT7UtF_Iz8lx6HZo';

            async function fetchPlayers() {
                try {
                    const response = await fetch(`${supabaseUrl}/rest/v1/players?select=*`, {
                        headers: { 'apikey': supabaseKey, 'Authorization': `Bearer ${supabaseKey}` }
                    });
                    allPlayers = await response.json();
                    displayPlayers(allPlayers);
                } catch (error) { console.error("Erreur:", error); }
            }

            window.displayPlayers = function(players) {
                const container = document.getElementById('players-container');
                container.innerHTML = '';
                players.forEach((player, index) => {
                    let s = (player.status || 'Amateur').toLowerCase();
                    let badgeClass = s === 'pro' ? 'status-pro' : (s.includes('free') ? 'status-free' : 'status-amateur');
                    
                    container.innerHTML += `
                        <div class="player-card">
                            <div class="player-badge ${badgeClass}">${player.status || 'Amateur'}</div>
                            <img src="${player.photo_url || 'https://via.placeholder.com/150'}" alt="">
                            <h3>${player.full_name}</h3>
                            <p>üìç ${player.position || 'N/A'}</p>
                            <button onclick="showDetails(${index}, '${player.full_name}')" style="width:100%; background:#D4AF37 !important; color:#000 !important; font-weight:bold; border:none; height:40px; border-radius:5px; cursor:pointer;">VIEW PROFILE</button>
                        </div>`;
                });
            }

            window.filterPlayers = function(category) {
                const filtered = (category === 'all') 
                    ? allPlayers 
                    : allPlayers.filter(p => (p.status || '').toLowerCase().includes(category.toLowerCase()));
                displayPlayers(filtered);
            };

            window.showDetails = function(index, fullName) {
                // On retrouve le joueur par son nom pour √©viter les erreurs d'index apr√®s filtrage
                const player = allPlayers.find(p => p.full_name === fullName);
                const details = document.getElementById("modalDetails");
                details.innerHTML = `
                    <h2 style="color:#D4AF37;">${player.full_name}</h2>
                    <p>${player.position} | ${player.nationality}</p>
                    <hr style="border-color:#333;">
                    <div style="display:grid; grid-template-columns:1fr 1fr; gap:10px; font-size:13px;">
                        <div><label style="color:#D4AF37; display:block; font-size:10px;">PIED</label>${player.preferred_foot || 'N/A'}</div>
                        <div><label style="color:#D4AF37; display:block; font-size:10px;">VALEUR</label>${player.market_value || 'N/A'}</div>
                    </div>
                    <div style="margin-top:20px; padding:10px; background:#222; border-left:3px solid #D4AF37; font-style:italic;">
                        "${player.scout_comment || 'Analyse en cours...'}"
                    </div>`;
                document.getElementById("playerModal").style.display = "block";
            };

            const modal = document.getElementById("playerModal");
            document.querySelector(".close-modal").onclick = () => modal.style.display = "none";
            window.onclick = (e) => { if(e.target == modal) modal.style.display = "none"; };

            fetchPlayers();
        });
    </script>
</body>
</html>

